---
import BaseHead from "../../components/BaseHead.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "../../consts";
import { getCollection } from "astro:content";

const allPosts = await getCollection("blog");
const categories = [
  ...new Set(allPosts.map((post) => post.data.category).filter((cat) => cat)),
];
const pageTitle = "Category Index";
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={pageTitle} description={SITE_DESCRIPTION} />
  </head>
  <body
    class="bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 antialiased flex flex-col min-h-screen transition-colors"
  >
    <Header />
    <main class="w-full max-w-4xl mx-auto px-4 py-12 grow">
      <h1 class="text-4xl font-bold mb-8">Categories</h1>
      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
        {
          categories.map((category) => (
            <a
              href={`/categories/${category}`}
              class="block p-6 bg-gray-50 dark:bg-gray-800 rounded-xl hover:shadow-lg transition-all border border-gray-100 dark:border-gray-700 hover:border-blue-500 dark:hover:border-blue-500 group"
            >
              <h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100 group-hover:text-blue-600 dark:group-hover:text-blue-400 mb-2">
                {category}
              </h2>
              <p class="text-gray-500 dark:text-gray-400">
                {
                  allPosts.filter((post) => post.data.category === category)
                    .length
                }{" "}
                posts
              </p>
            </a>
          ))
        }
      </div>
    </main>
    <Footer />
  </body>
</html>
